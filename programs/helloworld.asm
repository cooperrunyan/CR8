#include "<std>/arch.asm"
#include "<std>/macros.asm"

jmp [main]

#include "<std>/math.asm"

#mem 128 IMG [
    0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,
    0b01100001100000000001101100000000000001100000011000000000000000000110000011000000000000000000000000000000000000000000000000000000,
    0b01100001100000000001101100000000000001100000011000000000000000000110000011000000000000000000000000000000000000000000000000000000,
    0b01111111100111111001101100111111000001100000011001111111001111100110000011000000000000000000000000000000000000000000000000000000,
    0b01111111100111111001101100110011000001100110011001100011001100000110011111000000000000000000000000000000000000000000000000000000,
    0b01100001100110000001101100110011000001101110110001100011001000000110011001000000000000000000000000000000000000000000000000000000,
    0b01100001100111111001101100111111000000111001100001111111001000000110011111000000000000000000000000000000000000000000000000000000,
    0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,
]
; #mem 128 IMG [
;     0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,
;     0b10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,
;     0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,
;     0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,
;     0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,
;     0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,
;     0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,
;     0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,
; ]


main:
    mb 0x01
    mov %c, 0
    mov %z, 128

    push [IMG >> 8]
    push [IMG & 0x00FF]
    push [BRAM >> 8]
    push [BRAM & 0x00FF]

    jnza [.loop], %z
    jmp [.done]

    .loop:
        dec %z
        pop %b
        pop %c
        pop %l
        pop %h
        lw %a
        inc16 %l, %h
        push %h
        push %l
        mov %l, %b
        mov %h, %c
        sw %a
        inc16 %l, %h
        push %h
        push %l
        jnza [.loop], %z
        jmp [.done]


    .done:
        jmp [.done]
        halt

